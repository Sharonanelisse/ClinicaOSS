<ui:composition template="/templates/layout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <ui:define name="content">
        <h1>Gestión de Descuentos y Seguros</h1>

        <!-- ==================== BLOQUE DE DESCUENTOS ==================== -->
        <h2>Descuentos</h2>
        <h:form citaId="frmDescuentos">
            <p:growl citaId="msgDescuento" showDetail="true" life="4000" />

            <!-- Formulario de descuentos -->
            <h:panelGrid columns="2" columnClasses="label,value">
                <h:outputLabel value="Nombre promoción:" for="nombrePromocion"/>
                <p:inputText citaId="nombrePromocion" value="#{descuentoBean.selected.nombrePromocion}" required="true"/>

                <h:outputLabel value="Descripción promoción:" for="descripcionPromocion"/>
                <p:inputTextarea citaId="descripcionPromocion" value="#{descuentoBean.selected.descripcionPromocion}" rows="3" required="true"/>

                <h:outputLabel value="Porcentaje descuentoId:" for="descuentoPromocion"/>
                <p:inputText citaId="descuentoPromocion" value="#{descuentoBean.selected.descuentoPromocion}" />

                <h:outputLabel value="Estado:" for="estado"/>
                <p:selectBooleanCheckbox citaId="estado" value="#{descuentoBean.selected.estado}" />
            </h:panelGrid>

            <!-- Botones -->
            <p:commandButton value="Guardar"
                             action="#{descuentoBean.save}"
                             update="tblDescuentos,frmDescuentos,msgDescuento"
                             icon="pi pi-check" />

            <p:commandButton value="Cancelar"
                             action="#{descuentoBean.newEntity}"
                             update="frmDescuentos"
                             icon="pi pi-times"
                             styleClass="p-button-secondary" />

            <!-- Tabla de descuentos -->
            <p:dataTable citaId="tblDescuentos"
                         value="#{descuentoBean.list}"
                         var="d"
                         paginator="true"
                         rows="10"
                         style="margin-top:20px;"
                         rowKey="#{d.citaId}"
                         selectionMode="single"
                         selection="#{descuentoBean.selected}">

                <p:column headerText="ID">
                    <h:outputText value="#{d.citaId}" />
                </p:column>

                <p:column headerText="Nombre">
                    <h:outputText value="#{d.nombrePromocion}" />
                </p:column>

                <p:column headerText="Descripción">
                    <h:outputText value="#{d.descripcionPromocion}" />
                </p:column>

                <p:column headerText="Descuento (%)">
                    <h:outputText value="#{d.descuentoPromocion}" />
                </p:column>

                <p:column headerText="Estado">
                    <h:outputText value="#{d.estado ? 'Activo' : 'Inactivo'}" />
                </p:column>

                <p:column headerText="Acciones">
                    <p:commandButton value="Editar"
                                     action="#{descuentoBean.edit(d)}"
                                     update="frmDescuentos"
                                     icon="pi pi-pencil" />

                    <p:commandButton value="Eliminar"
                                     action="#{descuentoBean.delete(d)}"
                                     update="tblDescuentos"
                                     icon="pi pi-trash"
                                     styleClass="ui-button-danger" />
                </p:column>
            </p:dataTable>
        </h:form>

        <!-- ==================== BLOQUE DE SEGUROS ==================== -->
        <h2 style="margin-top:40px;">Seguros</h2>
        <h:form citaId="frmSeguros">
            <p:growl citaId="msgSeguro" showDetail="true" life="4000" />

            <!-- Formulario de seguros -->
            <h:panelGrid columns="2" columnClasses="label,value">
                <h:outputLabel value="Código aseguradora:" for="codigoAseguradora"/>
                <p:inputText citaId="codigoAseguradora" value="#{seguroBean.selected.codigoAseguradora}" required="true"/>

                <h:outputLabel value="Nombre aseguradora:" for="nombreAseguradora"/>
                <p:inputText citaId="nombreAseguradora" value="#{seguroBean.selected.nombreAseguradora}" required="true"/>

                <h:outputLabel value="Porcentaje descuentoId:" for="porcentajeDescuento"/>
                <p:inputText citaId="porcentajeDescuento" value="#{seguroBean.selected.porcentajeDescuento}" />

                <h:outputLabel value="Fecha inicio:" for="fechaInicio"/>
                <p:datePicker citaId="fechaInicio" value="#{seguroBean.selected.fechaInicio}" pattern="yyyy-MM-dd"/>

                <h:outputLabel value="Deducible:" for="deducible"/>
                <p:inputText citaId="deducible" value="#{seguroBean.selected.deducible}" />

                <h:outputLabel value="Fecha final:" for="fechaFinal"/>
                <p:datePicker citaId="fechaFinal" value="#{seguroBean.selected.fechaFinal}" pattern="yyyy-MM-dd"/>

                <h:outputLabel value="Estado:" for="estadoSeguro"/>
                <p:selectBooleanCheckbox citaId="estadoSeguro" value="#{seguroBean.selected.estado}" />
            </h:panelGrid>

            <!-- Botones -->
            <p:commandButton value="Guardar"
                             action="#{seguroBean.save}"
                             update="tblSeguros,frmSeguros,msgSeguro"
                             icon="pi pi-check" />

            <p:commandButton value="Cancelar"
                             action="#{seguroBean.newEntity}"
                             update="frmSeguros"
                             icon="pi pi-times"
                             styleClass="p-button-secondary" />

            <!-- Tabla de seguros -->
            <p:dataTable citaId="tblSeguros"
                         value="#{seguroBean.list}"
                         var="s"
                         paginator="true"
                         rows="10"
                         style="margin-top:20px;"
                         rowKey="#{s.citaId}"
                         selectionMode="single"
                         selection="#{seguroBean.selected}">

                <p:column headerText="ID">
                    <h:outputText value="#{s.citaId}" />
                </p:column>

                <p:column headerText="Código">
                    <h:outputText value="#{s.codigoAseguradora}" />
                </p:column>

                <p:column headerText="Nombre">
                    <h:outputText value="#{s.nombreAseguradora}" />
                </p:column>

                <p:column headerText="Porcentaje descuentoId">
                    <h:outputText value="#{s.porcentajeDescuento}" />
                </p:column>

                <p:column headerText="Fecha inicio">
                    <h:outputText value="#{s.fechaInicio}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>
                </p:column>

                <p:column headerText="Fecha final">
                    <h:outputText value="#{s.fechaFinal}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>
                </p:column>

                <p:column headerText="Deducible">
                    <h:outputText value="#{s.deducible}" />
                </p:column>

                <p:column headerText="Estado">
                    <h:outputText value="#{s.estado ? 'Activo' : 'Inactivo'}" />
                </p:column>

                <p:column headerText="Acciones">
                    <p:commandButton value="Editar"
                                     action="#{seguroBean.edit(s)}"
                                     update="frmSeguros"
                                     icon="pi pi-pencil" />

                    <p:commandButton value="Eliminar"
                                     action="#{seguroBean.delete(s)}"
                                     update="tblSeguros"
                                     icon="pi pi-trash"
                                     styleClass="ui-button-danger" />
                </p:column>
            </p:dataTable>
        </h:form>
    </ui:define>
</ui:composition>
