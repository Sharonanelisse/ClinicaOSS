<ui:composition template="/templates/layout.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <ui:define name="content">
        <h1>Gestión de Descuentos y Seguros</h1>

        <!-- ==================== BLOQUE DE DESCUENTOS ==================== -->
        <h2>Descuentos</h2>
        <h:form id="frmDescuentos">
            <p:growl id="msgDescuento" showDetail="true" life="4000" />

            <h:panelGrid columns="2" columnClasses="label,value">

                <h:outputLabel value="Nombre promoción:" for="nombrePromocion"/>
                <p:inputText id="nombrePromocion"
                             value="#{descuentoBean.selected.nombrePromocion}"
                             required="true"/>

                <h:outputLabel value="Descripción promoción:" for="descripcionPromocion"/>
                <p:inputTextarea id="descripcionPromocion"
                                 value="#{descuentoBean.selected.descripcionPromocion}"
                                 rows="3"
                                 required="true"/>

                <h:outputLabel value="Porcentaje descuento (%):" for="descuentoPromocion"/>
                <p:inputText id="descuentoPromocion"
                             value="#{descuentoBean.selected.descuentoPromocion}" />

                <h:outputLabel value="Estado:" for="estadoDescuento"/>
                <p:selectBooleanCheckbox id="estadoDescuento"
                                         value="#{descuentoBean.selected.estado}" />
            </h:panelGrid>

            <p:commandButton value="Guardar"
                             action="#{descuentoBean.save}"
                             update=":frmDescuentos:tblDescuentos :frmDescuentos :frmDescuentos:msgDescuento"
                             icon="pi pi-check" />

            <p:commandButton value="Cancelar"
                             action="#{descuentoBean.newEntity}"
                             update="frmDescuentos"
                             icon="pi pi-times"
                             styleClass="p-button-secondary" />

            <!-- Tabla -->
            <p:dataTable id="tblDescuentos"
                         value="#{descuentoBean.list}"
                         var="d"
                         paginator="true"
                         rows="10"
                         style="margin-top:20px;"
                         rowKey="#{d.id}"
                         selectionMode="single"
                         selection="#{descuentoBean.selected}">

                <p:column headerText="ID">
                    <h:outputText value="#{d.id}" />
                </p:column>

                <p:column headerText="Nombre">
                    <h:outputText value="#{d.nombrePromocion}" />
                </p:column>

                <p:column headerText="Descripción">
                    <h:outputText value="#{d.descripcionPromocion}" />
                </p:column>

                <p:column headerText="Descuento (%)">
                    <h:outputText value="#{d.descuentoPromocion}" />
                </p:column>

                <p:column headerText="Estado">
                    <h:outputText value="#{d.estado ? 'Activo' : 'Inactivo'}" />
                </p:column>

                <p:column headerText="Acciones">
                    <p:commandButton value="Editar"
                                     action="#{descuentoBean.edit(d)}"
                                     update="frmDescuentos"
                                     icon="pi pi-pencil" />

                    <p:commandButton value="Eliminar"
                                     action="#{descuentoBean.delete(d)}"
                                     update=":frmDescuentos:tblDescuentos"
                                     icon="pi pi-trash"
                                     styleClass="ui-button-danger" />
                </p:column>

            </p:dataTable>
        </h:form>

        <!-- ==================== BLOQUE DE SEGUROS ==================== -->
        <h2 style="margin-top:40px;">Seguros</h2>
        <h:form id="frmSeguros">
            <p:growl id="msgSeguro" showDetail="true" life="4000" />

            <h:panelGrid columns="2" columnClasses="label,value">

                <h:outputLabel value="Código aseguradora:" for="codigoAseguradora"/>
                <p:inputText id="codigoAseguradora"
                             value="#{seguroBean.selected.codigoAseguradora}"
                             required="true"/>

                <h:outputLabel value="Nombre aseguradora:" for="nombreAseguradora"/>
                <p:inputText id="nombreAseguradora"
                             value="#{seguroBean.selected.nombreAseguradora}"
                             required="true"/>

                <h:outputLabel value="Porcentaje descuento (%):" for="porcentajeDescuento"/>
                <p:inputText id="porcentajeDescuento"
                             value="#{seguroBean.selected.porcentajeDescuento}" />

                <h:outputLabel value="Fecha inicio:" for="fechaInicio"/>
                <p:datePicker id="fechaInicio"
                              value="#{seguroBean.selected.fechaInicio}"
                              pattern="yyyy-MM-dd"/>

                <h:outputLabel value="Deducible:" for="deducible"/>
                <p:inputText id="deducible"
                             value="#{seguroBean.selected.deducible}" />

                <h:outputLabel value="Fecha final:" for="fechaFinal"/>
                <p:datePicker id="fechaFinal"
                              value="#{seguroBean.selected.fechaFinal}"
                              pattern="yyyy-MM-dd"/>

                <h:outputLabel value="Estado:" for="estadoSeguro"/>
                <p:selectBooleanCheckbox id="estadoSeguro"
                                         value="#{seguroBean.selected.estado}" />
            </h:panelGrid>

            <p:commandButton value="Guardar"
                             action="#{seguroBean.save}"
                             update=":frmSeguros:tblSeguros :frmSeguros :frmSeguros:msgSeguro"
                             icon="pi pi-check" />

            <p:commandButton value="Cancelar"
                             action="#{seguroBean.newEntity}"
                             update="frmSeguros"
                             icon="pi pi-times"
                             styleClass="p-button-secondary" />

            <p:dataTable id="tblSeguros"
                         value="#{seguroBean.list}"
                         var="s"
                         paginator="true"
                         rows="10"
                         style="margin-top:20px;"
                         rowKey="#{s.id}"
                         selectionMode="single"
                         selection="#{seguroBean.selected}">

                <p:column headerText="ID">
                    <h:outputText value="#{s.id}" />
                </p:column>

                <p:column headerText="Código">
                    <h:outputText value="#{s.codigoAseguradora}" />
                </p:column>

                <p:column headerText="Nombre">
                    <h:outputText value="#{s.nombreAseguradora}" />
                </p:column>

                <p:column headerText="Porcentaje descuento">
                    <h:outputText value="#{s.porcentajeDescuento}" />
                </p:column>

                <p:column headerText="Fecha inicio">
                    <h:outputText value="#{s.fechaInicio}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>
                </p:column>

                <p:column headerText="Fecha final">
                    <h:outputText value="#{s.fechaFinal}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>
                </p:column>

                <p:column headerText="Deducible">
                    <h:outputText value="#{s.deducible}" />
                </p:column>

                <p:column headerText="Estado">
                    <h:outputText value="#{s.estado ? 'Activo' : 'Inactivo'}" />
                </p:column>

                <p:column headerText="Acciones">
                    <p:commandButton value="Editar"
                                     action="#{seguroBean.edit(s)}"
                                     update="frmSeguros"
                                     icon="pi pi-pencil" />

                    <p:commandButton value="Eliminar"
                                     action="#{seguroBean.delete(s)}"
                                     update=":frmSeguros:tblSeguros"
                                     icon="pi pi-trash"
                                     styleClass="ui-button-danger" />
                </p:column>

            </p:dataTable>
        </h:form>
    </ui:define>
</ui:composition>
